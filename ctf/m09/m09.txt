ソーシャルハック？


犯人を追い詰めろ
http://chat.quals.seccon.jp/


アドレスにアクセスして、ソースを表示。
スクリプトがeval(function(p,a,c,k,e,r){から始まっている。
JavaScript圧縮・難読化ツール「packer」を使っていることがわかる。


人工無脳との会話
はい
いいですよ
と送信すると会話が続く。


画像サーバーの用意
自分で管理するWebサーバにダミーの画像ファイルを用意する。
root権限が使えるなら、tcpdumpコマンドでHTTPポート80番のパケットをキャプチャできる。

$ tcpdump port 80 -n -s 0 -w http_log.pcap

試しに手元のブラウザでアクセスしてみる。
http://serverIP/tmp/webmoney.jpg

コンソールからCtrl+Cでtcpdumpを終了し、手元のWiresharkでhttp_log.pcapを解析する。
該当行を右クリックし、「Follow」→「TCP Stream」でパケットキャプチャされた内容を確認する。


犯人に罠URLを踏ませてみる
チャットで詐欺犯から「買った後に番号の写真を撮って送ってください」と催促されるので、準備した写真のURLをチャットで知らせ、犯人がアクセスしてくれることを期待する。
画像ファイルの拡張子(.jpg/.png/.gif)が含まれるURLを送ると、「見たよ。」という意味深な回答が得られる。


アクセスログから犯人のIPアドレスを特定

$ tail -f /var/log/httpd/access_log

でWebサーバのログを確認する。
そうすると、犯人が使っていると思われるIPアドレス153.120.82.112から画像へアクセスした形跡が確認できる。


最後の行を見ると、User-Agentの欄に"MyVNCpasswordIsVNCpass123"と記載がある。


nmapでポートスキャン
犯人と思われるIPアドレス153.120.82.112に対してnmapでポートスキャンをかけてみる。

$ nmap 153.120.82.112

このサーバーでは、sshやX11サーバの他に、5901〜5903ポートにVNCサービスが立ち上がっている。


VNCクライアントでログイン
VNCクライアントを使って153.120.82.112::5901へアクセスする。

表示されるデスクトップ画面のメモ帳に書かれているフラグを確認。

FLAG{giveMeYourWebM0n3y}





