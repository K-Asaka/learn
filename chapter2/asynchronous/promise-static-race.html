<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta charset="utf-8">
        <script>
            // 待機用の関数
            function wait(tm, isResolve = true) {
                // Promiseオブジェクトを戻り値にする
                return new Promise((resolve, reject) => {
                    // tmミリ秒待って実行
                    setTimeout(() => {
                        // コンソールに情報を出力
                        console.log(tm, isResolve ? 'resolve' : 'reject');
                        
                        if (isResolve) {
                            // isResolveがtrueなら解決
                            resolve(`${tm}!`);
                        } else {
                            // isResolveがfalseなら拒否
                            reject(`${tm}`);
                        }
                    }, tm);
                });
            };

            // .race() その1
            setTimeout(() => {
                console.log('--- .race() その1 ---');

                // Promiseオブジェクトの配列を作成
                const arr = [wait(10, true), wait(20, false), wait(30, true)];

                // .race()の処理
                Promise.race(arr).then(data => {
                    // 成功時
                    console.log('@ then :', data);
                }).catch(data => {
                    // 失敗時
                    console.log('@ catch :', data);
                });
            }, 0);

            // .race() その2
            setTimeout(() => {
                console.log('--- .race() その ---');

                // Promiseオブジェクトの配列を作成
                const arr = [wait(10, false), wait(20, true), wait(30, false)];

                // .race()の処理
                Promise.race(arr).then(data => {
                    // 成功時
                    console.log('@ then :', data);
                }).catch(data => {
                    // 失敗時
                    console.log('@ catch :', data);
                });
            }, 100);
        </script>
    </head>
    <body>
    </body>
</html>