mod integer;
mod overflow;
mod float;
mod character;


// æˆ»ã‚Šå€¤ã®å‹ã‚’çœç•¥ã€‚ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã¯æˆ»ã‚Šå€¤ãŒãƒ¦ãƒ‹ãƒƒãƒˆå‹ã ã¨è§£é‡ˆã™ã‚‹
fn hello() {
    println!("Hello");    
}

// é–¢æ•°f1ã¯å‘¼ã³å‡ºã—å…ƒã®å€¤ã®ã‚³ãƒ”ãƒ¼ã‚’å¼•æ•°nã«æŸç¸›ã—ã€1ã«å¤‰æ›´ã™ã‚‹
fn f1(mut n: u32) {
    n = 1;
    println!("f1:       n = {}", n);
}

// é–¢æ•°f2ã¯å‘¼ã³å‡ºã—å…ƒã®å€¤ã‚’æŒ‡ã™ãƒã‚¤ãƒ³ã‚¿ã‚’å—ã‘å–ã‚Šã€ãƒã‚¤ãƒ³ã‚¿ãŒæŒ‡ã™å ´æ‰€ã«2ã‚’æ ¼ç´ã™ã‚‹
fn f2(n_ptr: &mut u32) {
    println!("f2:   n_ptr = {:p}", n_ptr);

    // *ã‚’ä»˜ã‘ã‚‹ã¨å‚ç…§å…ˆã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã€‚ã“ã‚Œã‚’å‚ç…§å¤–ã—(dereference)ã¨å‘¼ã¶
    *n_ptr = 2;
    println!("n:  *n_ptr = {}", *n_ptr);
}

// ã“ã®é–¢æ•°ã¯å¼•æ•°ã‚’2å€ã—ãŸå€¤ã‚’è¿”ã™
fn double(n: i32) -> i32 {
    n + n
}

// ã“ã®é–¢æ•°ã¯å¼•æ•°ã®çµ¶å¯¾å€¤ã‚’è¿”ã™
fn abs(n: i32) -> i32 {
    if n >= 0 { n } else { -n }
}

// ã“ã®é–¢æ•°ã¯&[char]å‹ã®ã‚¹ãƒ©ã‚¤ã‚¹ã‚’å¼•æ•°ã«å–ã‚Šã€ãã®æƒ…å ±ã‚’è¡¨ç¤ºã™ã‚‹
fn print_info(name: &str, sl: &[char]) {
    println!("  {:9} - {}, {:?}, {:?}, {:?}",
            name,
        sl.len(),       // é•·ã•(ãƒã‚¤ãƒˆæ•°)   usizeå‹
        sl.first(),     // æœ€åˆã®è¦ç´        Option<char>å‹
        sl[1],          // 2ç•ªç›®ã®è¦ç´       charå‹
        sl.last()       // æœ€å¾Œã®è¦ç´        Option<char>å‹
    );
}

fn main() {
    // æ•´æ•°ãƒªãƒ†ãƒ©ãƒ«
    let n = 42;
    println!("{}", n);

    // æ–‡å­—ãƒªãƒ†ãƒ©ãƒ«
    let c = 'R';
    println!("{}", c);

    // é–¢æ•°ã‚’å‘¼ã³å‡ºã—ã€(ãªã„ã¯ãšã®)æˆ»ã‚Šå€¤ã«å¤‰æ•°retã‚’æŸç¸›ã™ã‚‹
    let ret = hello();
    // ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ã§retã®å€¤ãŒãƒ¦ãƒ‹ãƒƒãƒˆå€¤ã¨ç­‰ã—ã„ã“ã¨ã‚’æ¤œæŸ»ã™ã‚‹
    assert_eq!(ret, ());
    // size_of::<å‹>()ã¯ã€ãã®å‹ã®å€¤ãŒãƒ¡ãƒ¢ãƒªä¸Šã§å ã‚ã‚‹å¤§ãã•ã‚’ãƒã‚¤ãƒˆæ•°ã§è¿”ã™
    println!("{}", std::mem::size_of::<()>());
    assert_eq!(std::mem::size_of::<()>(), 0);   // 0ãƒã‚¤ãƒˆ

    let b1 = true;
    let b2 = !b1;   // falseã€å¦å®š
    println!("b2={}", b2);

    let n1 = 8;
    let n2 = 12;
    let b3 = n1 >= 10;  // false
    let b4 = n2 >= 10;  // true
    let b5 = b3 && b4;  // falseã€ã‚·ãƒ§ãƒ¼ãƒˆã‚µãƒ¼ã‚­ãƒƒãƒˆè«–ç†ç©
    let b6 = b3 || b4;  // trueã€ã‚·ãƒ§ãƒ¼ãƒˆã‚µãƒ¼ã‚­ãƒƒãƒˆè«–ç†å’Œ
    println!("b5={}", b5);
    println!("b6={}", b6);

    assert_eq!(std::mem::size_of::<bool>(), 1); // ã‚µã‚¤ã‚ºã¯1ãƒã‚¤ãƒˆ

    integer::int();
    overflow::overflow();
    float::float();
    character::character();


    let mut n = 0;
    println!("main:     n = {}", n);

    f1(n);
    println!("main:     n = {}", n);

    // `&mut n`ã§nã®å€¤ã‚’æŒ‡ã™å¯å¤‰ã®ãƒã‚¤ãƒ³ã‚¿ã‚’ä½œæˆã™ã‚‹
    f2(&mut n);
    println!("main:     n = {}", n);

    let c1 = 'A';       // charå‹
    let c1_ptr = &c1;       // &charå‹ã€‚ã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«ãªå‚ç…§(ä¸å¤‰ã®å‚ç…§)
    assert_eq!(*c1_ptr, 'A');

    let mut n1 = 0; // i32å‹
    let n1_ptr = &mut n1;   // &mut i32å‹ã€‚ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«ãªå‚ç…§(å¯å¤‰ã®å‚ç…§)
    assert_eq!(*n1_ptr, 0);

    // å¯å¤‰ã®å‚ç…§ã§ã¯å‚ç…§å…ˆã®å€¤ã‚’å¤‰æ›´ã§ãã‚‹
    *n1_ptr = 1_000;
    assert_eq!(*n1_ptr, 1_000);

    let c1 = 'A';   // charå‹
    // '&'ã§å‚ç…§ã‚’ä½œã‚Šã€å‹å¼·åˆ¶ã§ç”Ÿãƒã‚¤ãƒ³ã‚¿ã«å¤‰æ›ã™ã‚‹
    let c1_ptr: *const char = &c1;  // *const charå‹ã€‚ä¸å¤‰ã®ç”Ÿãƒã‚¤ãƒ³ã‚¿
    // ç”Ÿãƒã‚¤ãƒ³ã‚¿ã®å‚ç…§å¤–ã—ã¯unsafeãªæ“ä½œ
    assert_eq!(unsafe { *c1_ptr }, 'A');

    let mut n1 = 0;     // i32å‹
    let n1_ptr: *mut i32 = &mut n1; // *mut i32å‹ã€‚å¯å¤‰ã®ç”Ÿãƒã‚¤ãƒ³ã‚¿
    assert_eq!(unsafe { *n1_ptr }, 0);

    // å¯å¤‰ã®ç”Ÿãƒã‚¤ãƒ³ã‚¿ã§ã¯å‚ç…§å…ˆã®å€¤ã‚’å¤‰æ›´ã§ãã‚‹
    unsafe {
        *n1_ptr = 1_000;
        assert_eq!(*n1_ptr, 1_000);
    }

    // å¤‰æ•°ã«å‹æ³¨é‡ˆã¨ã—ã¦é–¢æ•°ãƒã‚¤ãƒ³ã‚¿å‹ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§ã€é–¢æ•°åã‹ã‚‰é–¢æ•°ãƒã‚¤ãƒ³ã‚¿ã‚’å¾—ã‚‰ã‚Œã‚‹
    let mut f: fn(i32) -> i32 = double;
    assert_eq!(f(-42), -84);    // doubleé–¢æ•°ã§2å€ã•ã‚ŒãŸ

    // é–¢æ•°ãƒã‚¤ãƒ³ã‚¿ã®ã‚µã‚¤ã‚ºã¯usizeã¨åŒã˜(x86_64ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãªã‚‰8ãƒã‚¤ãƒˆ)
    assert_eq!(std::mem::size_of_val(&f), std::mem::size_of::<usize>());

    f = abs;
    assert_eq!(f(-42), 42);     // absé–¢æ•°ã§çµ¶å¯¾å€¤ã‚’å¾—ãŸ


    let x = 4;      // å¤‰æ•°xã‚’4ã«æŸç¸›ã™ã‚‹

    // ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ£ã‚’å®šç¾©ã™ã‚‹ã€‚ã™ã‚‹ã¨xãŒã‚¯ãƒ­ãƒ¼ã‚¸ãƒ£ã®ç’°å¢ƒã«è£œè¶³ã•ã‚Œã‚‹(ã‚­ãƒ£ãƒ—ãƒãƒ£ã•ã‚Œã‚‹)
    let adder = |n| n + x;
    assert_eq!(adder(2), 4 + 2);

    let mut state = false;
    // åˆ¥ã®ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ£ã‚’å®šç¾©ã™ã‚‹ã€‚ã“ã®ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ£ã¯å¼•æ•°ã‚’å–ã‚‰ãªã„
    let mut flipflop = || {
        // stateãŒè£œè¶³ã•ã‚Œã‚‹
        state = !state;     // çŠ¶æ…‹ã‚’åè»¢ã™ã‚‹
        state
    };

    // ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ£ã‚’å‘¼ã¶ãŸã³ã«è¿”ã‚‹å€¤ãŒåè»¢ã™ã‚‹
    assert!(flipflop());        // true
    assert!(!flipflop());       // false
    assert!(flipflop());        // true

    // ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ£ãŒè¿”ã™å€¤ã ã‘ã§ãªãã€stateã®å€¤ã‚‚å¤‰åŒ–ã—ã¦ã„ã‚‹
    assert!(state);             // true

    // ç’°å¢ƒã«ãªã«ã‚‚è£œè¶³ã—ãªã„ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ£ã¯é–¢æ•°ãƒã‚¤ãƒ³ã‚¿å‹ã«ãªã‚Œã‚‹
    let mut f: fn(i32) -> i32 = |n| n * 3;
    assert_eq!(f(-42), -126);

    // ç’°å¢ƒã«ãªã«ã‹ã‚’è£œè¶³ã™ã‚‹ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ£ã¯é–¢æ•°ãƒã‚¤ãƒ³ã‚¿å‹ã«ãªã‚Œãªã„
    // let x = 4;
    // f = |n| n * x;


    let t1 = (88, true);
    // ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰0ã®è¦ç´ (å·¦ã‹ã‚‰æ•°ãˆã¦æœ€åˆã®è¦ç´ )ã‚’å–ã‚Šå‡ºã™
    assert_eq!(t1.0, 88);

    // ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰1ã®è¦ç´ (2ç•ªç›®ã®è¦ç´ )ã‚’å–ã‚Šå‡ºã™
    assert_eq!(t1.1, true);

    // ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åã«ã¯ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚ã®å®šæ•°ã®ã¿ä½¿ãˆã‚‹ã€‚å¤‰æ•°ã¯ä¸å¯
    // let i = 0;
    // let t1a = t1.i; // ã‚¨ãƒ©ãƒ¼

    // è¦ç´ ã‚’æ›¸ãæ›ãˆã‚‹ã®ã§ã€å¤‰æ•°t1ã«mutã‚’ä»˜ã‘ã¦å¯å¤‰ã«ã™ã‚‹
    let mut t1 = (88, true);

    // ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰0ã®è¦ç´ ã‚’æ›¸ãæ›ãˆã‚‹
    t1.0 += 100;    // ç¾åœ¨ã®å€¤ã«100ã‚’è¶³ã™

    assert_eq!(t1, (188, true));

    let (n1, b1) = (88, true);
    assert_eq!(n1, 88);
    assert_eq!(b1, true);

    let ((x1, y1), (x2, y2)) = ((0, 5), (10, -1));
    assert_eq!(x1, 0);
    assert_eq!(y1, 5);
    assert_eq!(x2, 10);
    assert_eq!(y2, -1);

    // ä¸è¦ãªå€¤ã¯ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢ã‚’ä½¿ã†ã¨ç„¡è¦–ã§ãã‚‹
    let ((x1, y1), _) = ((0, 5), (10, -1));

    // è¦ç´ ã‚’æ›¸ãæ›ãˆã‚‹ã®ã§ã€å¤‰æ•°t1ã«mutã‚’ä»˜ã‘ã¦å¯å¤‰ã«ã™ã‚‹
    let mut t1 = ((0, 5), (10, -1));

    // è¦ç´ ã‚’æŒ‡ã™å¯å¤‰ã®å‚ç…§ã‚’å¾—ã‚‹ãŸã‚ã«ref mutã‚’è¿½åŠ ã™ã‚‹
    let ((ref mut x1_ptr, ref mut y1_ptr), _) = t1;

    // *ã‚’ä»˜ã‘ã‚‹ã“ã¨ã§ãƒã‚¤ãƒ³ã‚¿ãŒæŒ‡ã™ã‚¢ãƒ‰ãƒ¬ã‚¹ã«ã‚ã‚‹ãƒ‡ãƒ¼ã‚¿ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹
    *x1_ptr += 3;
    *y1_ptr *= -1;

    assert_eq!(t1, ((3, -5), (10, -1)));


    let a1 = [false, true, false];  // [bool; 3]å‹
    let a2 = [0.0, -1.0, 1.0, 0.5];                 // [f64; 4]å‹

    // `len()`ã§é…åˆ—ã®é•·ã•ã‚’å¾—ã‚‰ã‚Œã‚‹
    assert_eq!(a2.len(), 4);

    // é•·ã•100ã®é…åˆ—ã‚’ä½œã‚Šã€å…¨è¦ç´ ã‚’0i32ã§åˆæœŸåŒ–ã™ã‚‹
    // (è¦ç´ ã®å‹ã¯Copyãƒˆãƒ¬ã‚¤ãƒˆã‚’å®Ÿè£…ã—ã¦ã„ãªã‘ã‚Œã°ãªã‚‰ãªã„)
    let a3 = [0; 100];      // [i32; 100]å‹
    assert_eq!(a3.len(), 100);

    // é…åˆ—ã¯å…¥ã‚Œå­ã«ã§ãã‚‹
    let a4 = [['a', 'b'], ['c', 'd']];     // [[char; 2]; 2]å‹ã€‚2æ¬¡å…ƒé…åˆ—

    // é…åˆ—ã¯åŒã˜å‹ã®è¦ç´ ã®ä¸¦ã³ã€‚ç•°ãªã‚‹å‹ã®è¦ç´ ã¯æŒã¦ãªã„
    // let a5 = [false, 'a'];

    // é…åˆ—ã®é•·ã•ã¯å®Ÿè¡Œæ™‚ã«æŒ‡å®šã§ããªã„
    let size = 100;
    // let a1 = [0; size];  // ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼

    // ãƒ™ã‚¯ã‚¿ãªã‚‰å®Ÿè¡Œæ™‚ã«é•·ã•ã‚’æŒ‡å®šã§ãã‚‹
    let mut v1 = vec![0; size];   // Vec<i32>å‹
    assert_eq!(v1.len(), 100);              // é•·ã•ã¯100

    // ãƒ™ã‚¯ã‚¿ã«ã¯è¦ç´ ã‚’è¿½åŠ ã—ãŸã‚Šã€å‰Šé™¤ã—ãŸã‚Šã§ãã‚‹
    v1.push(1);                     // ãƒ™ã‚¯ã‚¿ã®æœ€å¾Œå°¾ã«è¦ç´ ã‚’è¿½åŠ ã™ã‚‹
    assert_eq!(v1.len(), 101);      // é•·ã•ã¯101ã«ãªã‚‹
    assert_eq!(v1.pop(), Some(1));  // ãƒ™ã‚¯ã‚¿ã®æœ€å¾Œå°¾ã‹ã‚‰è¦ç´ ã‚’å–ã‚Šé™¤ã
    assert_eq!(v1.len(), 100);      // é•·ã•ã¯100ã«æˆ»ã‚‹


    let array1 = ['H', 'e', 'l', 'l', 'o'];
    assert_eq!(array1[1], 'e');

    let mut array2 = [0, 1, 2];
    array2[1] = 10;
    assert_eq!(array2, [0, 10, 2]);

    // ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¯å®šæ•°ã§ãªãã¦ã‚‚ã‹ã¾ã‚ãªã„
    let mut index = 0;
    assert_eq!(array2[index], 0);
    index += 1;
    assert_eq!(array2[index], 10);

    let array3 = [0, 1];
    // println!(array3[2]);    // ã‚¨ãƒ©ãƒ¼ã€‚ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒç¯„å›²å¤–
    // let index = 2;
    // println!("{}", array3[index]); // ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ã«ãªã‚‰ãšã€å®Ÿè¡Œæ™‚ã«ãƒ‘ãƒ‹ãƒƒã‚¯ã™ã‚‹

    assert_eq!(array3.get(1), Some(&1));    // get()ã¯ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒç¯„å›²å†…ã®æ™‚ã¯Some(&å€¤)ã‚’è¿”ã™
    assert_eq!(array3.get(2), None);        // ã•ã‚‚ãªã‘ã‚Œã°Noneã‚’è¿”ã™


    let array4 = ['a'; 50];     // é•·ã•50

    // iter()ã§è¦ç´ ãŒä¸å¤‰ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ãƒ¼ã‚’ä½œæˆ
    for ch in array4.iter() {
        print!("{},", *ch);
    }

    let mut array5 = [1; 50];      // é•·ã•50
    // iter_mut()ã§è¦ç´ ãŒå¯å¤‰ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ã‚’ä½œæˆ
    for n in array5.iter_mut() {
        *n *= 2;
    }
    

    // é…åˆ—
    let a1 = ['a', 'b', 'c', 'd'];  // å‚ç…§å…ƒã®ãƒ‡ãƒ¼ã‚¿ã€‚[char; 4]å‹
    println!("a1: {:?}", a1);

    print_info("&a1[..]", &a1[..]); // &[char]å‹ã€‚å…¨è¦ç´ ã®ã‚¹ãƒ©ã‚¤ã‚¹
    print_info("&a1",     &a1);     // åŒä¸Š
    print_info("%a1[1..3]", &a1[1..3]); // bã¨cã‚’è¦ç´ ã¨ã™ã‚‹é•·ã•2ã®ã‚¹ãƒ©ã‚¤ã‚¹


    // ãƒ™ã‚¯ã‚¿
    let v1 = vec!['e', 'f', 'g', 'h'];  // å‚ç…§å…ƒã®ãƒ‡ãƒ¼ã‚¿ã€‚Vec<char>å‹
    println!("\nv1: {:?}", v1);

    print_info("&v1[..]", &v1[..]);     // &[char]å‹ã€‚å…¨è¦ç´ ã®ã‚¹ãƒ©ã‚¤ã‚¹
    print_info("&v1", &v1);             // åŒä¸Š
    print_info("&v1[1..3]", &v1[1..3]);     // &[char]å‹ã€‚fã¨gã‚’è¦ç´ ã¨ã™ã‚‹é•·ã•2ã®ã‚¹ãƒ©ã‚¤ã‚¹


    let mut a1 = [5, 4, 3, 2];    // é…åˆ—ã€‚[i32; 4]å‹
    let s1 = &mut a1[1..3];     // å¯å¤‰ã®ã‚¹ãƒ©ã‚¤ã‚¹ã€‚&mut[i32]å‹
    s1[0] = 6;                              // ã‚¹ãƒ©ã‚¤ã‚¹ã®æœ€åˆã®è¦ç´ ã‚’6ã«ã™ã‚‹
    s1[1] *= 10;                            // 2ç•ªç›®ã®è¦ç´ ã‚’10å€ã™ã‚‹
    s1.swap(0, 1);                     // è¦ç´ ã‚’äº¤æ›ã™ã‚‹
    assert_eq!(s1, [30, 6]);                // ã‚¹ãƒ©ã‚¤ã‚¹ã®å†…å®¹ã‚’ç¢ºèª

    // å‚ç…§å…ƒã®é…åˆ—ã®å†…å®¹ã‚’ç¢ºèª
    assert_eq!(a1, [5, 30, 6, 2]);          // ã‚¹ãƒ©ã‚¤ã‚¹ã‚’é€šã˜ã¦é…åˆ—ã®å†…å®¹ãŒå¤‰æ›´ã•ã‚ŒãŸ

    
    let a2: [i32; 0] = [];
    let s2 = &a2;                // ä¸å¤‰ã®ã‚¹ãƒ©ã‚¤ã‚¹ã‚’ä½œæˆ
    assert!(s2.is_empty());                 // ç©ºã®ã‚¹ãƒ©ã‚¤ã‚¹
    assert_eq!(s2.len(), 0);                // é•·ã•ã¯0
    assert_eq!(s2.first(), None);           // æœ€åˆã®è¦ç´ ã¯å­˜åœ¨ã—ãªã„

    let a3 = ["zero", "one", "two", "three", "four"];
    let s3 = &a3[1..4];            // ä¸å¤‰ã®ã‚¹ãƒ©ã‚¤ã‚¹ã‚’ä½œæˆ
    assert!(!s3.is_empty());                // ç©ºã§ã¯ãªã„
    assert_eq!(s3.len(), 3);                // é•·ã•ã¯3
    assert_eq!(s3.first(), Some(&"one"));   // æœ€åˆã®è¦ç´ 

    assert_eq!(s3[1], "two");               // 2ç•ªç›®ã®è¦ç´ 
    // assert_eq!(s3[3], "?");              // 4ç•ªç›®ã®è¦ç´ ã€‚å­˜åœ¨ã—ãªã„ã®ã§panicã™ã‚‹
    assert_eq!(s3.get(1), Some(&"two"));    // 2ç•ªç›®ã®è¦ç´ ã‚’å¾—ã‚‹åˆ¥ã®æ–¹æ³•
    assert_eq!(s3.get(3), None);            // 4ç•ªç›®ã®è¦ç´ ã€‚å­˜åœ¨ã—ãªã„ã®ã§None

    assert!(s3.contains(&"two"));           // "two"ã‚’è¦ç´ ã«æŒã¤
    assert!(s3.starts_with(&["one", "two"]));   // "one", "two"ã§å§‹ã¾ã‚‹
    assert!(s3.ends_with(&["two", "three"]));   // "two", "three"ã§çµ‚ã‚ã‚‹

    let mut a4 = [6, 4, 2, 8, 0, 9, 4, 3 ,7, 5, 1, 7];

    // ä¸€éƒ¨ã®è¦ç´ ã‚’æ˜‡é †ã«ã‚½ãƒ¼ãƒˆã™ã‚‹
    &mut a4[2..6].sort();
    assert_eq!(&a4[2..6], &[0, 2, 8, 9]);

    // ã‚¹ãƒ©ã‚¤ã‚¹ã‚’2ã¤ã®å¯å¤‰ã‚¹ãƒ©ã‚¤ã‚¹ã¸åˆ†å‰²ã™ã‚‹
    let (s4a, s4b) = &mut a4.split_at_mut(5);

    // å‰åŠã‚’é€†é †ã«ã™ã‚‹
    s4a.reverse();
    assert_eq!(s4a, &[8, 2, 0, 4, 6]);

    // å¾ŒåŠã‚’æ˜‡é †ã«ã‚½ãƒ¼ãƒˆã™ã‚‹
    s4b.sort_unstable();
    assert_eq!(s4b, &[1, 3, 4, 5, 7, 7, 9]);

    // sort()ã¨sort_unstable()ã®é•ã„
    // sort()ã¯å®‰å®šã‚½ãƒ¼ãƒˆãªã®ã§åŒé †ãªãƒ‡ãƒ¼ã‚¿ã®ã‚½ãƒ¼ãƒˆå‰ã®é †åºãŒã‚½ãƒ¼ãƒˆå¾Œã‚‚ä¿å­˜ã•ã‚Œã‚‹
    // sort_unstable()ã¯å®‰å®šã‚½ãƒ¼ãƒˆã§ã¯ãªã„ãŒã€ä¸€èˆ¬çš„ã«sort()ã‚ˆã‚Šé«˜é€Ÿ

    // &mutã‚’çœç•¥ã—ã¦ã‚‚çµæœã¯åŒã˜ã€‚å‹å¼·åˆ¶ã«ã‚ˆã£ã¦è‡ªå‹•çš„ã«ã‚¹ãƒ©ã‚¤ã‚¹ãŒä½œã‚‰ã‚Œã‚‹
    a4[2..6].sort();
    let (s4a, s4b) = a4.split_at_mut(5);


    let s1 = "abc1";        // &'static strå‹
    let s2 = "abc2";
    assert!(s1 < s2);
    assert!(s1 != s2);

    let s3 = "æ–‡å­—åˆ—ã‚’è¤‡æ•°è¡Œã«æ¸¡ã£ã¦æ›¸ãã¨
        æ”¹è¡Œã‚„ã‚¹ãƒšãƒ¼ã‚¹ãŒå…¥ã‚‹";
    let s4 = "è¡Œæœ«ã«ãƒãƒƒã‚¯ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã‚’ä»˜ã‘ã‚‹ã¨\
        æ”¹è¡Œãªã©ãŒå…¥ã‚‰ãªã„";
    
    assert_eq!(s3, "æ–‡å­—åˆ—ã‚’è¤‡æ•°è¡Œã«æ¸¡ã£ã¦æ›¸ãã¨\n        æ”¹è¡Œã‚„ã‚¹ãƒšãƒ¼ã‚¹ãŒå…¥ã‚‹");
    assert_eq!(s4, "è¡Œæœ«ã«ãƒãƒƒã‚¯ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã‚’ä»˜ã‘ã‚‹ã¨æ”¹è¡Œãªã©ãŒå…¥ã‚‰ãªã„");

    let s5 = "æ–‡å­—åˆ—ã«\"ã¨\\ã‚’å«ã‚ã‚‹";  // ãƒãƒƒã‚¯ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã§ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—
    let s6 = r#"æ–‡å­—åˆ—ã«"ã¨\ã‚’å«ã‚ã‚‹"#; // rawæ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«ã€‚æ­£è¦è¡¨ç¾ãªã©ã«ä¾¿åˆ©
    assert_eq!(s5, s6);

    let s7 = r###"ã“ã®ã‚ˆã†ã«#ã®æ•°ã‚’å¢—ã‚„ã™ã¨"##"ãŒã‚ã£ã¦ã‚‚å¤§ä¸ˆå¤«"###;
    assert_eq!(s7, "ã“ã®ã‚ˆã†ã«#ã®æ•°ã‚’å¢—ã‚„ã™ã¨\"##\"ãŒã‚ã£ã¦ã‚‚å¤§ä¸ˆå¤«");

    let s8 = "ã‚‚ã¡ã‚ã‚“çµµæ–‡å­—\u{1f600}ã‚‚ä½¿ãˆã‚‹"; // ã‚‚ã¡ã‚ã‚“çµµæ–‡å­—ğŸ˜€ã‚‚ä½¿ãˆã‚‹

    let fruits = "ã‚ã‹ã‚Šã‚“ã”, ã‚ãŠã‚Šã‚“ã”\nãƒ©ã‚ºãƒ™ãƒªãƒ¼, ãƒ–ãƒ©ãƒƒã‚¯ãƒ™ãƒªãƒ¼";

    // lines()ãƒ¡ã‚½ãƒƒãƒ‰ã¯æ”¹è¡Œã‚³ãƒ¼ãƒ‰(\n)ã‚’å«ã‚€æ–‡å­—åˆ—ã‹ã‚‰1è¡Œãšã¤å–ã‚Šå‡ºã›ã‚‹ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ã‚’ä½œã‚‹
    let mut lines = fruits.lines();
    // ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ã®next()ãƒ¡ã‚½ãƒƒãƒ‰ã§æ¬¡ã®è¡Œã‚’å¾—ã‚‹ã€‚
    let apple_line = lines.next();
    assert_eq!(apple_line, Some("ã‚ã‹ã‚Šã‚“ã”, ã‚ãŠã‚Šã‚“ã”"));
    assert_eq!(lines.next(), Some("ãƒ©ã‚ºãƒ™ãƒªãƒ¼, ãƒ–ãƒ©ãƒƒã‚¯ãƒ™ãƒªãƒ¼"));
    // æ¬¡ã®è¡ŒãŒãªã„ãªã‚‰NoneãŒè¿”ã‚‹
    assert_eq!(lines.next(), None);

    // ã‚Šã‚“ã”ã®è¡Œ(Some(..))ã®ä¸­èº«ã‚’å–ã‚Šå‡ºã™ã€‚
    if let Some(apples) = apple_line {
        // ã€Œã‚ã‹ã€ã§å§‹ã¾ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
        assert!(apples.starts_with("ã‚ã‹"));
        // ã€Œã‚Šã‚“ã”ã€ã®æ–‡å­—ã‚’å«ã‚€ã‹ãƒã‚§ãƒƒã‚¯
        assert!(apples.contains("ã‚Šã‚“ã”"));
        // ã€Œã‚ãŠã€ãŒæœ€åˆã«å‡ºç¾ã™ã‚‹ä½ç½®(UTF-8è¡¨ç¾ã§ä½•ãƒã‚¤ãƒˆç›®)ã‚’å¾—ã‚‹
        assert_eq!(apples.find("ã‚ãŠ"), Some(17));  // 0å§‹ã¾ã‚Šãªã®ã§18ãƒã‚¤ãƒˆç›®

        // æ–‡å­—åˆ—ã‚’ã‚«ãƒ³ãƒ(,)ã§åˆ†å‰²ã™ã‚‹ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ã‚’ä½œã‚‹
        let mut apple_iter = apples.split(",");
        assert_eq!(apple_iter.next(), Some("ã‚ã‹ã‚Šã‚“ã”"));

        let green = apple_iter.next();
        // å·¦å´ã«ä½™ç™½ãŒã‚ã‚‹ã€‚
        assert_eq!(green, Some(" ã‚ãŠã‚Šã‚“ã”"));
        // Some(..)ã®å†…å®¹ã«strã®trim()ãƒ¡ã‚½ãƒƒãƒ‰ã‚’é©ç”¨ã—ã¦ä½™ç™½ã‚’å–ã‚Šé™¤ã
        assert_eq!(green.map(str::trim), Some("ã‚ãŠã‚Šã‚“ã”"));

        assert_eq!(apple_iter.next(), None);
    } else {
        unreachable!();     // ã‚‚ã—ã“ã“ã«åˆ°é”ã—ãŸã‚‰ãƒ‘ãƒ‹ãƒƒã‚¯ã§å¼·åˆ¶çµ‚äº†ã™ã‚‹
    }

    // s1ã‹ã‚‰s4ã¯ã©ã‚Œã‚‚ç”»é¢ä¸Šã§ã¯1æ–‡å­—ã¨ã—ã¦è¡¨ç¤ºã•ã‚Œã‚‹
                                // UTF-8è¡¨ç¾
    let s1 = "a";       // 61
    let s2 = "ã‚";      // E3 81 82
    let s3 = "ğŸ˜€";      // F0 9F 98 80
    let s4 = "ğŸ‡¯ğŸ‡µ";      // F0 9F 87 AF F0 9F 87 B5

    // len()ãƒ¡ã‚½ãƒƒãƒ‰ã¯UTF-8ã®ãƒã‚¤ãƒˆæ•°ã‚’è¿”ã™
    assert_eq!(s1.len(), 1);
    assert_eq!(s2.len(), 3);
    assert_eq!(s3.len(), 4);
    assert_eq!(s4.len(), 8);

    let s = "abcã‚ã„ã†";
    assert_eq!(s.get(0..1), Some("a"));
    assert_eq!(s.get(3..6), Some("ã‚"));
    assert_eq!(s.get(3..4), None);      // UTF-8ã¨ã—ã¦è§£é‡ˆã§ããªã„å ´åˆ

    let s = "ã‹ã‹\u{3099}ã";   // \u{3099}ã¯æ¿ç‚¹æ–‡å­—
    println!("{}", s);      // ã‹ãŒã

    let mut iter = s.chars();
    assert_eq!(iter.next(), Some('ã‹'));
    assert_eq!(iter.next(), Some('ã‹'));
    assert_eq!(iter.next(), Some('\u{3099}'));
    assert_eq!(iter.next(), Some('ã'));
    assert_eq!(iter.next(), None);

    let utf8: [u8; 4] = [0x61, 0xe3, 0x81, 0x82];
    assert_eq!(std::str::from_utf8(&utf8), Ok("aã‚"));

    let bad_utf8: [u8; 2] = [0x81, 0x33];       // ã§ãŸã‚‰ã‚ãªãƒã‚¤ãƒˆåˆ—
    let result2 = std::str::from_utf8(&bad_utf8);
    assert!(result2.is_err());
    println!("{:?}", result2);

    // æ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«(&'static str)ã‹ã‚‰&mut strã¯ç›´æ¥å¾—ã‚‰ã‚Œãªã„
    // ã¾ãšæ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«ã‚’Stringã¸å¤‰æ›ã—ã€ãã“ã‹ã‚‰&mut strã‚’å–ã‚Šå‡ºã™
    let mut s1 = "abcã‚ã„ã†".to_string();   // Stringå‹

    // &mut strã‚’å¾—ã‚‹ã€‚ã“ã‚Œã¯StringãŒæŒã¤UTF-8ãƒã‚¤ãƒˆåˆ—ã‚’æŒ‡ã™å¯å¤‰ã‚¹ãƒ©ã‚¤ã‚¹
    let s2 = s1.as_mut_str();   // &mut strå‹

    // è‹±å°æ–‡å­—ã‚’å¤§æ–‡å­—ã«å¤‰æ›´
    s2.make_ascii_uppercase();
    assert_eq!(s2, "ABCã‚ã„ã†");

    // &mut strã®UTF-8ãƒã‚¤ãƒˆåˆ—ã‚’ç›´æ¥æ“ä½œã—ã¦"ã‚"(3ãƒã‚¤ãƒˆ)ã‚’"*a*"ã«å¤‰æ›´ã™ã‚‹
    let b = unsafe { s2.as_bytes_mut() };

    b[3] = b'*';
    b[4] = b'a';
    b[5] = b'*';

    // å¤§å…ƒã®StringãŒå¤‰æ›´ã•ã‚Œã¦ã„ã‚‹
    assert_eq!(s1, "ABC*a*ã„ã†");
    

}
