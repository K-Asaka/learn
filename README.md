# 学習記録用リポジトリ

## スッキリわかるJava入門　第3版

### 6.2 複数クラスで構成されるプログラム

#### 複数クラスのコンパイル

複数のソースファイルを`javac`コマンドでコンパイルするには次のようにする。

```
javac ソースファイル1.java ソースファイル2.java
```


#### Javaプログラムの完成品

- Javaプログラムの完成品は、複数のクラスファイルの集合体
- 誰かに配布する場合には、すべてのクラスファイルを渡す必要がある


#### プログラムの実行方法

クラスファイルが入ったフォルダをまるごと受け取った場合は、クラス名を指定して実行する必要がある。

```
java クラス名
```

JVMは起動時に指定されたクラスの中にあるmainメソッドを呼び出してプログラムの実行を開始する。よって、Javaのプログラムを実行する人は「渡された複数のクラスファイルのうち、mainメソッドが含まれているクラスの名前」を指定する必要がある。  

#### 複数の完成クラスファイルを渡す場合の注意点

すべてのクラスファイルを渡すだけでなく、「mainメソッドが含まれるクラス名」も伝える必要がある。


### JARファイル

プログラムの完成品が複数のクラスファイルになった場合、そのままではメールで送る際などに不便である。そこでJavaでは、「複数のクラスファイルを1つにまとめるファイル形式」として**JAR**(Java ARchive)が定められている。JARファイルはZIPファイルとよく似たアーカイブファイルで、JDKに付属する`jar`コマンドでも作成することができる。


### パッケージに属したクラスの実行方法

パッケージに所属させたクラスを実行するには、クラス名だけを指定しても実行させることが出来ない。
`java`コマンドに、起動したいクラスの完全限定クラス名(FQCN: Full Qualified Class Name)を指定する。

```
java 起動したいクラスの完全限定クラス名(FQCN)
```

#### クラス名だけでクラスファイルを探し出すためのしくみ

JVMが持つクラスローダーはクラスパス(classpath)を使って目的のクラスファイルを探し出す。
クラスパスとは「クラスローダーがクラスファイルを探し出す際に、見に行くべきフォルダの場所」のことで、あらかじめ1つ以上の場所を指定しておく。  


#### クラスパスの指定方法

- 方法1：起動時にjavaコマンドで指定する  
javaコマンドでJVMを起動する際に、`-cp`オプションまたは`-classpath`オプションで指定する方法。
```
java -cp c:\work クラス名
```

- 方法2：検索場所をOSに登録しておく  
OSの環境変数にクラスパスを登録しておくことができる。


- 方法3：特に指定しない  
環境変数に指定がなく、`-cp`オプションの指定もない場合、通常はjavaコマンドが実行されたフォルダがクラスパスとなる。


#### クラスパスで指定できる対象

- 対象1：フォルダの場所  
クラスファイルが置かれているフォルダの場所(絶対パス)を指定するもので、最も一般的。

- 対象2：クラスファイルが入ったJARファイルやZIPファイル  
クラスファイルが入っているJARファイルやZIPファイルがあれば、そのファイルの場所(絶対パス)をクラスパスとして指定することができる。クラスローダーは指定されたファイルの中を検索し、もしクラスファイルが見つかれば読み込む。

- 対象3：複数のフォルダ、JAR／ZIPファイル、それらの組み合わせ  
複数のフォルダやJARファイル、ZIPファイルをデリミタ文字で区切ってクラスパスに指定できる。
デリミタ文字は、Windowsの場合はセミコロン(;)、macOSやLinuxの場合はコロン(:)。
クラスローダーは、指定された場所を前から順に探していく。

Windowsの例
```
c:\work;c:\work\jars\calcapp.jar
```

LinuxやmacOSの例
```
/var/javadev:/var/javadev/jars/calcapp.jar
```

#### クラスファイルの正しい配置

あるパッケージx.y.zに属するクラスCを探す場合、クラスローダーは「クラスパスで指定されたフォルダ\x\y\z\C.class」というファイルを読み込む。  
パッケージに属したクラスファイルをクラスローダーに読み込んでもらうには、現在のクラスパスを基準として、パッケージ階層に対応したフォルダ階層を作り、その中に必要なクラスファイルを配置しておく必要がある。


### JavaAPIについて

```
java -verbose:class クラス名
```
`-verbose:class`オプションにより、JVMに読み込まれたクラスの完全限定クラス名が取得できる。
